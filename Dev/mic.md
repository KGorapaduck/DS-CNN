# 🎤 마이크 구성 방안 분석

> **프로젝트:** Re:Boot — Edge KWS + 서버 STT 분산 아키텍처  
> **핵심 질문:** 마이크를 라즈베리파이에 달 것인가, PC에 달 것인가, 양쪽 다 필요한가?  
> **작성일:** 2026-02-24

---

## 1. 오디오가 필요한 두 곳

| 기기 | 용도 | 요구사항 |
|------|------|----------|
| **라즈베리파이** | KWS (키워드 감지) | 1초 단위 실시간 오디오, 16kHz |
| **PC (교수자 노트북)** | Whisper STT → 퀴즈 생성 | 트리거 이후 수~십 초 오디오 |

---

## 2. 방안 비교

### 방안 A: 마이크 → 라즈베리파이만 (⭐ 추천)

```
[마이크] → [라즈베리파이]
               ├─ KWS 수행 (로컬)
               └─ TRIGGER_ON 시 → 오디오 스트림을 PC로 전송
                                        ↓
                                   [PC: Whisper STT → LLM 퀴즈 생성]
```

| 장점 | 단점 |
|------|------|
| 마이크 1개로 해결 (하드웨어 최소화) | PC가 오디오를 수신받아야 하므로 네트워크 스트리밍 구현 필요 |
| RPi가 "스마트 마이크" 역할 → **포트폴리오 가치 극대화** | RPi에서 수음 + KWS 동시 수행 (단, 1GB로 충분) |
| `role_strategy.md`의 Edge-Controller 설계 철학과 일치 | |
| 프라이버시: 원본 음성이 로컬에서 1차 통제됨 | |

---

### 방안 B: 마이크 → PC만

```
[마이크] → [PC]
            ├─ Whisper STT (자막/요약)
            └─ 오디오 스트림을 RPi로 전송
                    ↓
               [라즈베리파이: KWS 수행]
                    ↓ TRIGGER_ON
               [PC: 퀴즈 생성]
```

| 장점 | 단점 |
|------|------|
| PC가 자막용 오디오도 필요하면 자연스러움 | RPi가 PC에 의존적 → "독립적 엣지" 의미 퇴색 |
| PC 오디오 품질이 더 좋을 수 있음 | PC→RPi 스트리밍 지연 → KWS 실시간성 저하 |
| | `role_strategy.md`의 Edge 분리 철학과 **모순** |

---

### 방안 C: 두 기기 모두 연결 (무선 마이크 분배 or 마이크 2개)

```
[마이크] → 분배/무선 → [라즈베리파이: KWS]
                      → [PC: Whisper STT]
```

| 장점 | 단점 |
|------|------|
| 각 기기가 완전 독립 (네트워크 스트리밍 불필요) | 마이크 2개 또는 분배기 필요 |
| 가장 단순한 소프트웨어 구현 | 같은 음원 이중 캡처 → 비효율 |

---

## 3. 추천: 방안 A (마이크 → 라즈베리파이)

### 추천 이유

1. **Edge-Controller 설계 일치** — RPi가 물리 센서(마이크)를 직접 제어하는 엣지 컨트롤러
2. **포트폴리오 차별화** — "엣지가 오디오를 1차 처리 후 필요할 때만 서버에 전달"하는 IoT/Edge AI 정석 패턴
3. **프라이버시** — 강의 원본 음성이 외부 송출 전 로컬에서 1차 통제
4. **구현 난이도** — pyaudio 수음 + 소켓 전송은 비교적 간단

### 구현 흐름

```
[라즈베리파이]
 1. USB 마이크로 상시 수음 (pyaudio, 16kHz)
 2. 1초 오디오 프레임마다 KWS 추론 (tflite_runtime)
 3. 키워드 감지 시:
    ├─ PC로 TRIGGER_ON 신호 전송 (TCP 소켓)
    └─ 이후 N초간 오디오 버퍼를 PC로 스트리밍

[PC]
 1. TRIGGER_ON 수신 대기 (소켓 서버)
 2. 수신 시 → RPi로부터 오디오 스트림 수신
 3. Whisper STT → 텍스트 추출
 4. ChatGPT API → 퀴즈 JSON 생성
 5. WebSocket → 학생 프론트엔드 팝업
```

---

## 4. 예외 상황

> 메인 자막 시스템(Whisper)도 **상시 자막 생성**이 필요하다면, PC에도 별도 마이크 또는 RPi로부터의 상시 오디오 스트리밍이 필요함 → 이 경우 **방안 C** 또는 **방안 A + 상시 스트리밍** 고려.
>
> 자막 시스템이 팀 내 다른 분 담당이라면, 본인 파트는 **방안 A**로 충분.
